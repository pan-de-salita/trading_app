<div>
  <h1>Details</h1>
  <ul>
    <% @stocks.uniq(&:ticker).each do |stock| %>
      <li>
        <strong>Ticker:</strong>
        <%= stock.ticker %>
      </li>
      <li>
        <strong>Company Name:</strong>
        <%= stock.company_name %>
      </li>
      <li>
        <strong>Current Price:</strong>
        <%= stock.price %>
      </li>
      <li>
        <strong>No. Of Shares Owned:</strong>
        <%= Transaction.total_shares(current_user.id, stock.id) %>
      </li>
      <li>
        <strong>Average Price:</strong>
        <%= Transaction.avg_price(current_user.id, stock.id) %>
      </li>
      <li>
        <strong>Gains/Losses:</strong>
        <!-- TODO: make this pretty -->
        <%= current_user
          .transactions
          .filter { |transaction| transaction.stock_id == stock.id }
          .reduce(0) do |total, filtered_transaction|
            total + filtered_transaction.calc_gains_or_losses
          end /
          current_user
            .transactions
            .filter { |transaction| transaction.stock_id == stock.id }
            .count %>
      </li>
    <% end %>
  </ul>
</div>
