<h1 class="text-center mt-5">Stock Search</h1>

<div class="container mt-5">
  <% if @q.present? %>
    <%= search_form_for @q, url: stocks_path, method: :get, html: { class: "d-flex flex-column align-items-center" } do |f| %>
      <div class="input-group mb-3 w-75">
        <%= f.search_field :company_name_or_ticker_cont,
                       class: "form-control form-control-lg",
                       placeholder: "Search for a stock..." %>
        <div class="input-group-append">
          <%= f.submit "Search", class: "btn btn-primary" %>
        </div>
      </div>
    <% end %>
  <% end %>
</div>

<% @stocks.each do |stock| %>
  Ticker:
  <%= stock.ticker %>
  <br>
  Company name:
  <%= stock.company_name %>
  <br>
  <div data-turbo-prefetch="false">
    <%= link_to "Get Stock Quote", stock_path(stock.id) %>
  </div>
  <br>
<% end %>

<div class="card-deck container mt-5 d-flex flex-wrap">
  <% if @random_news_articles.feed %>
    <% @random_news_articles.feed.first(12).each do |news| %>
      <div class="my-4">
        <div class="col-md-4">
          <div class="card">
            <img
              src="<%= news[:banner_image] %>"
              class="card-img-top"
              alt="news banner image"
            >
            <div class="card-body">
              <h5 class="card-title"><%= news["title"] %></h5>
              <p class="card-text"><%= news["summary"] %></p>
              <p class="card-text"><small class="text-muted"><%= news["source_domain"] %></small></p>
              <p class="card-text"><small class="text-muted"><%= news["time_published"] %></small></p>
            </div>
          </div>
        </div>
      </div>
    <% end %>
  <% end %>
</div>

<% button_to "Sign Out",
destroy_user_session_path,
method: :delete,
class: "btn btn-danger" %>
<% link_to "Edit Account", edit_user_registration_path %>
<% link_to "Stocks", stocks_path %>
<!-- WRITE THE SEARCH BAR HERE -->
<br>
<!-- WRITE THE NEWS STUFF HERE -->
